/* Global Styles */
@import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,600;1,600&display=swap');

:root {
    --primary-color: #7b2cbf;
    --secondary-color: #3a86ff;
    --accent-color: #ff006e;
    --text-color: #ffffff;
    --dark-bg: #10002b;
    --glass-bg: rgba(20, 20, 40, 0.4);
    --glass-border: rgba(255, 255, 255, 0.1);
    --neon-glow: 0 0 10px var(--primary-color), 0 0 20px var(--accent-color);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body,
html {
    width: 100%;
    height: 100%;
    overflow: hidden;
    /* Prevent scrolling of the body, let the UI layer scroll if needed */
    font-family: 'Outfit', sans-serif;
    background-color: #000;
    color: var(--text-color);
}

/* 3D Canvas Container */
#canvas-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    pointer-events: all;
    /* Allow 3D interaction */
}


/* UI Layer - sits on top of 3D */
.ui-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10;
    pointer-events: none;
    /* Let clicks pass through */
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    /* Push footer down */
    overflow-y: hidden;
    /* Use specific scroll areas instead */
    padding-bottom: 0;
    /* Player is fixed, no need for padding here if using fixed/flex correctly */
}

/* Enable pointer events on actual UI elements */
.ui-layer header,
.ui-layer section,
.ui-layer button,
.ui-layer .glass-panel,
.player-controls,
.actions-sidebar,
.personal-message {
    pointer-events: auto;
}

/* Footer - Ensure it's bottom */
footer {
    text-align: center;
    padding: 1rem;
    font-size: 0.8rem;
    opacity: 0.7;
    background: rgba(0, 0, 0, 0.5);
    /* Readable bg */
    margin-top: auto;
    /* Push to bottom manually if flex fails */
    margin-bottom: 80px;
    /* Above player */
    pointer-events: none;
    /* Just text */
    z-index: 5;
}

/* Sidebar Update for Visibility */
.actions-sidebar {
    /* Ensure it's clearly visible */
    background: rgba(0, 0, 0, 0.2);
    /* Slight backing */
    border-radius: 20px;
    padding: 10px;
    backdrop-filter: blur(5px);
}

.btn-label {
    text-shadow: 0 2px 4px black;
    font-weight: 800;
}

@media (max-width: 768px) {

    /* Mobile tweaks */
    .actions-sidebar {
        /* On mobile, labels might be helpful. Let's show them small? */
        align-items: center;
        background: transparent;
        /* Remove box on mobile to save space */
        backdrop-filter: none;
    }

    .action-btn-container {
        flex-direction: column;
        /* Stack label below icon on mobile */
        gap: 2px;
    }

    .btn-label {
        display: block;
        /* Show labels! */
        font-size: 0.6rem;
        background: rgba(0, 0, 0, 0.7);
        padding: 2px 5px;
        border-radius: 4px;
        opacity: 1;
        transform: none;
    }

    footer {
        font-size: 0.7rem;
        margin-bottom: 140px;
        /* Higher for mobile player */
    }
}

/* Typography & Header */
header {
    text-align: center;
    padding: 2rem 1rem;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.8), transparent);
}

.logo {
    font-size: 1.2rem;
    letter-spacing: 4px;
    font-weight: 800;
    color: var(--accent-color);
    text-transform: uppercase;
    margin-bottom: 0.5rem;
    text-shadow: 0 0 10px var(--accent-color);
}

.heart {
    animation: heartbeat 1.5s infinite;
    color: #ff4d6d;
}

@keyframes heartbeat {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.3);
    }
}

h1 {
    font-family: 'Playfair Display', serif;
    font-size: 2.5rem;
    background: linear-gradient(45deg, #fff, var(--secondary-color));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow: 0 0 20px rgba(58, 134, 255, 0.5);
}

#girl-name-span {
    color: var(--accent-color);
    font-style: italic;
}

/* Sidebar actions - DESIGN AMÉLIORÉ */
.actions-sidebar {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    flex-direction: column;
    gap: 15px;
    z-index: 50;
    pointer-events: auto;
    align-items: flex-end;
}

.action-btn-container {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-direction: row-reverse;
    transition: all 0.3s ease;
}

.action-btn-container:hover {
    transform: translateX(-5px);
}

.glass-btn.icon-only {
    width: 55px;
    height: 55px;
    border-radius: 50%;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.4rem;
    background: linear-gradient(135deg, rgba(123, 44, 191, 0.2), rgba(58, 134, 255, 0.2));
    border: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 4px 20px rgba(123, 44, 191, 0.3);
    color: white;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    position: relative;
    overflow: hidden;
}

.glass-btn.icon-only::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.glass-btn.icon-only:hover::before {
    width: 100%;
    height: 100%;
}

.glass-btn.icon-only:hover,
.glass-btn.icon-only:active {
    transform: scale(1.1);
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    box-shadow: 0 0 30px rgba(123, 44, 191, 0.6), 0 0 60px rgba(58, 134, 255, 0.4);
    border-color: white;
}

.glass-btn.icon-only i {
    position: relative;
    z-index: 1;
}

.btn-label {
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(20, 20, 40, 0.9));
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 700;
    opacity: 0;
    transform: translateX(10px);
    transition: all 0.3s ease;
    pointer-events: none;
    white-space: nowrap;
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.action-btn-container:hover .btn-label {
    opacity: 1;
    transform: translateX(0);
}

/* Message Popup pour Mobile */
.message-popup {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(10px);
    z-index: 200;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease;
}

.message-popup.active {
    display: flex;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

.message-popup-content {
    background: linear-gradient(135deg, rgba(20, 10, 40, 0.95), rgba(40, 20, 60, 0.95));
    border: 2px solid rgba(123, 44, 191, 0.5);
    border-radius: 20px;
    padding: 2rem;
    max-width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    animation: slideUp 0.4s ease;
    position: relative;
}

@keyframes slideUp {
    from {
        transform: translateY(50px);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.message-popup-close {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.3);
    color: white;
    font-size: 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s;
}

.message-popup-close:hover {
    background: var(--accent-color);
    transform: rotate(90deg);
    border-color: white;
}

/* Bouton pour ouvrir le message sur mobile */
.message-toggle-btn {
    display: none;
    position: fixed;
    top: 60px;
    left: 50%;
    transform: translateX(-50%);
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 25px;
    padding: 10px 20px;
    font-size: 0.9rem;
    font-weight: 700;
    cursor: pointer;
    z-index: 90;
    box-shadow: 0 4px 20px rgba(123, 44, 191, 0.5);
    transition: all 0.3s;
    animation: pulse 2s infinite;
}

@keyframes pulse {

    0%,
    100% {
        box-shadow: 0 4px 20px rgba(123, 44, 191, 0.5);
    }

    50% {
        box-shadow: 0 4px 30px rgba(123, 44, 191, 0.8);
    }
}

.message-toggle-btn:hover {
    transform: translateX(-50%) scale(1.05);
}

/* Lyric / Message Overlay */
.lyrics-overlay {
    text-align: center;
    margin: 1rem auto;
    min-height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
}

.current-lyric {
    font-family: 'Playfair Display', serif;
    font-size: 1.4rem;
    color: rgba(255, 255, 255, 0.95);
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
    padding: 0.5rem 1rem;
    background: transparent;
    /* Remove box background for cleaner look */
    /* text-shadow handles legibility */
}

/* Glass Panels (Playlist & Message) */
.glass-panel {
    /* Default glass style, but position will be handled specifically for sections */
    background: rgba(10, 5, 20, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
    transition: 0.3s;
}

.playlist-section {
    position: fixed;
    top: 100px;
    /* Below header */
    left: 20px;
    width: 250px;
    max-height: calc(100vh - 200px);
    /* Fit between header and player */
    overflow-y: auto;
    padding: 1.5rem;
    z-index: 40;
    pointer-events: auto;
    display: flex;
    flex-direction: column;
}

/* Scrollbar for playlist */
.playlist-section::-webkit-scrollbar {
    width: 4px;
}

.playlist-section::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 2px;
}

/* Message Section - Keep it overlaid but less obtrusive, or moved?
   Let's keep message centered but ephemeral or top.
   Actually, let's move message to bottom right or integrated.
   For now, keep message default but ensure it doesn't block. */
.personal-message {
    position: fixed;
    top: 100px;
    right: 80px;
    /* Left of sidebar actions */
    width: 300px;
    padding: 1.5rem;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(123, 44, 191, 0.1));
    pointer-events: auto;
    display: none;
    /* Hide by default, maybe show on intro? */
    /* Wait, the user wants to see the message. Let's make it start visible then fade or be dismissible. */
    /* Better: Make it part of the UI flow but not covering the center. */
}

/* Force message distinct from standard glass panel flow */
#message-section {
    display: block;
    /* Restore visibility */
    margin: 0;
    /* Reset auto margin */
}

.glass-panel h3 {
    margin-bottom: 1rem;
    font-weight: 600;
    color: var(--secondary-color);
    text-transform: uppercase;
    font-size: 0.8rem;
    letter-spacing: 2px;
}

/* Playlist Items */
.playlist-container {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.song {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 15px;
    /* Smaller padding */
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.02);
    cursor: pointer;
    transition: 0.2s;
    border: 1px solid transparent;
}

.song:hover {
    background: rgba(255, 255, 255, 0.1);
}

.song.active {
    background: rgba(123, 44, 191, 0.3);
    border-left: 3px solid var(--primary-color);
}

.song-info-group {
    display: flex;
    flex-direction: column;
}

.song-title {
    font-size: 0.9rem;
}

.song-artist {
    font-size: 0.8rem;
    opacity: 0.7;
}

/* Music Player Bottom Bar */
.player-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: rgba(10, 5, 20, 0.9);
    backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    padding: 15px;
    z-index: 100;
}

.player-inner {
    max-width: 800px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.progress-container {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.8rem;
    color: #aaa;
}

.progress-bar {
    flex-grow: 1;
    height: 4px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 2px;
    cursor: pointer;
    position: relative;
}

.progress {
    height: 100%;
    background: var(--secondary-color);
    width: 0%;
    border-radius: 2px;
}

.controls-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.now-playing {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 30%;
}

.album-art {
    width: 40px;
    height: 40px;
    background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.track-info {
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.track-title {
    font-size: 0.9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 150px;
}

.track-artist {
    font-size: 0.7rem;
    opacity: 0.7;
}

.main-controls {
    display: flex;
    gap: 20px;
    align-items: center;
}

.control-btn {
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    font-size: 1.2rem;
    transition: 0.2s;
}

.control-btn:hover {
    color: var(--secondary-color);
}

.control-btn.play-pause {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    background: white;
    color: black;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

.volume-control {
    width: 30%;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 10px;
}

.volume-slider {
    width: 80px;
    height: 4px;
    -webkit-appearance: none;
    appearance: none;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
}

.volume-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 12px;
    height: 12px;
    background: white;
    border-radius: 50%;
    cursor: pointer;
}

/* Mobile Responsiveness - OPTIMISÉ POUR VISIBILITÉ DU PODIUM */
@media (max-width: 768px) {

    /* Header compact et fixe */
    header {
        padding: 0.3rem;
        background: rgba(0, 0, 0, 0.9);
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 100;
    }

    .logo {
        font-size: 0.7rem;
        margin: 0;
    }

    h1 {
        font-size: 1rem;
        margin: 0;
    }

    /* AFFICHER le bouton toggle message */
    .message-toggle-btn {
        display: block;
    }

    /* MASQUER les éléments qui bloquent la vue du podium */
    .personal-message {
        display: none !important;
    }

    .playlist-section {
        display: none !important;
    }

    /* Les paroles restent visibles mais repositionnées */
    .lyrics-overlay {
        display: flex !important;
        /* Garder visible sur mobile */
        position: fixed;
        top: 50%;
        transform: translate(-50%, -50%);
        bottom: auto;
        z-index: 30;
        /* En dessous des boutons d'action */
    }

    /* Boutons d'action repositionnés EN BAS */
    .actions-sidebar {
        position: fixed;
        bottom: 90px;
        left: 10px;
        right: auto;
        top: auto;
        flex-direction: row;
        gap: 8px;
        background: rgba(0, 0, 0, 0.8);
        padding: 8px;
        border-radius: 25px;
        backdrop-filter: blur(10px);
        align-items: center;
        justify-content: center;
    }

    .action-btn-container {
        flex-direction: column;
        gap: 3px;
        align-items: center;
    }

    .glass-btn.icon-only {
        width: 45px;
        height: 45px;
        font-size: 1.3rem;
        background: rgba(123, 44, 191, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.3);
        transition: all 0.3s;
    }

    .glass-btn.icon-only:active {
        background: var(--primary-color);
        transform: scale(0.95);
    }

    /* Labels TOUJOURS visibles sur mobile */
    .btn-label {
        display: block !important;
        font-size: 0.55rem;
        background: transparent;
        padding: 0;
        opacity: 1;
        transform: none;
        color: white;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    /* Player ultra-compact */
    .player-controls {
        padding: 8px;
        background: rgba(0, 0, 0, 0.95);
        border-top: 1px solid rgba(123, 44, 191, 0.5);
    }

    .controls-row {
        gap: 8px;
        justify-content: space-between;
        align-items: center;
    }

    .now-playing {
        width: 35%;
        min-width: 100px;
    }

    .track-title {
        max-width: 80px;
        font-size: 0.75rem;
        font-weight: 600;
    }

    .track-artist {
        display: none;
    }

    .album-art {
        width: 35px;
        height: 35px;
    }

    .volume-control {
        display: flex !important;
        /* Afficher le volume sur mobile */
        width: auto;
        flex-grow: 1;
        justify-content: flex-end;
    }

    .volume-slider {
        width: 60px;
        /* Plus petit sur mobile */
    }

    .main-controls {
        gap: 8px;
    }

    .control-btn {
        font-size: 1.1rem;
        padding: 5px;
    }

    .control-btn.play-pause {
        width: 40px;
        height: 40px;
    }

    .ui-layer {
        padding-bottom: 0;
        padding-top: 45px;
    }

    footer {
        display: none;
    }

    #canvas-container {
        height: calc(100vh - 65px);
        /* Ajuster la hauteur */
    }
}

/* Scrollbar for horizontal playlist on mobile */
.playlist-container::-webkit-scrollbar {
    height: 4px;
}

.playlist-container::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
}

/* Signature & Message styles */
.message-content {
    font-family: 'Playfair Display', serif;
    font-style: italic;
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 1rem;
}

.signature {
    text-align: right;
    color: var(--accent-color);
    font-weight: 600;
}

/* Galerie de photos de Livia */
.livia-gallery {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin-bottom: 1.5rem;
    padding: 10px;
}

.gallery-item {
    position: relative;
    overflow: hidden;
    border-radius: 12px;
    aspect-ratio: 1;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.gallery-item:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(123, 44, 191, 0.5);
    z-index: 10;
}

.livia-photo {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.4s ease;
}

.gallery-item:hover .livia-photo {
    transform: scale(1.1);
}

/* Affichage amélioré des paroles */
.lyrics-overlay {
    position: fixed;
    bottom: 120px;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 600px;
    text-align: center;
    z-index: 60;
    pointer-events: none;
}

.current-lyric {
    font-family: 'Playfair Display', serif;
    font-size: 1.6rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.95);
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.9),
        0 0 20px rgba(123, 44, 191, 0.5);
    padding: 1rem 2rem;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 10, 40, 0.6));
    backdrop-filter: blur(10px);
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: opacity 0.5s ease;
    line-height: 1.4;
}

/* Mobile: Paroles plus petites et repositionnées */
@media (max-width: 768px) {
    .lyrics-overlay {
        position: fixed;
        /* Position idéale : un peu au-dessus du centre pour laisser voir le podium */
        top: 25%;
        left: 50%;
        transform: translateX(-50%);
        bottom: auto;
        width: 95%;
        display: flex !important;
        /* Override le display:none du mobile */
        pointer-events: none;
        /* Toujours pouvoir cliquer à travers */
        z-index: 50;
        align-items: flex-start;
        justify-content: center;
    }

    .current-lyric {
        font-size: 1.1rem;
        padding: 0.8rem 1.2rem;
        background: rgba(0, 0, 0, 0.4);
        /* Plus transparent sur mobile */
        border: none;
        box-shadow: none;
        /* Moins intrusif */
        text-shadow: 0 2px 4px black;
        /* Lisibilité max */
    }

    .livia-gallery {
        grid-template-columns: repeat(2, 1fr);
        gap: 8px;
        padding: 5px;
    }
}